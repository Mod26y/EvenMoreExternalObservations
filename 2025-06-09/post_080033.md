Original Article: https://www.bleepingcomputer.com/news/microsoft/microsoft-shares-script-to-restore-inetpub-folder-you-shouldnt-delete/

1) What happened: Microsoft rolled out an April 2025 security update that inadvertently created an empty C:\Inetpub folder on all Windows systems, including those without Internet Information Services (IIS) installed. This folder, crucial for addressing a significant privilege escalation vulnerability (CVE-2025-21204), was mistakenly deleted by some users. To counteract this, Microsoft released a PowerShell script that regenerates the folder with appropriate permissions to protect against security risks emerging from improper link resolution within the Windows Update Stack.

2) Why it matters: The C:\Inetpub folder’s inadvertent creation led to confusion because it typically pertains to IIS, which was not required in this context. The folder’s role in mitigating a serious security flaw underlines its importance; without it, Windows systems are exposed to privilege escalation attacks, allowing attackers to manipulate crucial files under the SYSTEM account. This situation highlights the need for clear communication between software providers and users regarding changes in security measures and system architecture to prevent exposing systems to avoidable vulnerabilities.

3) What actions should be taken: IT administrators should execute the provided PowerShell script to restore the empty C:\Inetpub folder and ensure it is set with the proper permissions to mitigate the vulnerability efficiently. Training sessions may be needed to underscore the implications of unauthorized deletions on system security. Further, organizations could establish policies to educate users to refrain from removing unknown or seemingly obsolete system files without guidance. Regular communication and updates regarding system changes from software providers can minimize confusion and associated risks.