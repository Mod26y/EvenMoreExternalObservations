Original Article: https://www.bleepingcomputer.com/news/security/microsoft-says-attackers-use-exposed-aspnet-keys-to-deploy-malware/

In the reported incident, attackers exploited ASP.NET ViewState code injection attacks by utilizing static machine keys exposed online. These keys, often found on code documentation and repository sites, are intended for securing ViewState data from tampering. However, hackers have leveraged them to craft malicious ViewStates, which are executed by targeted servers, allowing remote code execution. An incident was observed where attackers used a known key to deploy the Godzilla framework, capable of executing malicious commands on IIS servers. Microsoft's findings highlighted over 3,000 publicized keys posing significant risks due to their accessibility.

This issue is critical as it highlights how publicly disclosed sensitive information can be weaponized, potentially leading to unauthorized remote code execution on affected servers. The misuse of static machine keys could enable attackers to not only execute malicious code but also establish persistent backdoors, facilitating further compromises. Moreover, the widespread availability of these keys, including in development environments, heightens the risk of such vulnerabilities being exploited on a broad scale, necessitating urgent attention and remediation efforts from developers and organizations.

To mitigate these risks, organizations should ensure the secure generation and management of ASP.NET machine keys, avoiding default or publicly available keys. Developers are advised to encrypt configuration elements containing sensitive data and upgrade applications to ASP.NET 4.8 to utilize AMSI functionalities. Windows Servers can be hardened by applying attack surface reduction rules to prevent webshell creation. If systems are compromised, a thorough investigation should be conducted, potentially involving the re-formatting and reinstallation of affected servers to eliminate persistence threats. Microsoft also provides guidance on updating or removing vulnerable keys.