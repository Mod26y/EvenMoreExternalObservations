Original Article: https://www.bleepingcomputer.com/news/security/whoami-attacks-give-hackers-code-execution-on-amazon-ec2-instances/

The "whoAMI" attack identified by DataDog researchers targets Amazon Web Services (AWS) environments, specifically infiltrating EC2 instances via misleading Amazon Machine Images (AMIs). This attack exploits vulnerabilities in systems that use lax AMI retrieval practices, such as not specifying an AMI's owner and using scripts that employ wildcards. Consequently, hackers can offer malicious AMIs that imitate trusted ones, tricking users into launching compromised virtual machines. Although AWS has patched internal vulnerabilities, many customers remain at risk if they haven’t updated their configurations to prevent the retrieval of malicious AMIs.

This vulnerability significantly influences cloud security, emphasizing how easily managed services like AWS can become entry points for adversaries if misconfigured. Given the widespread use of AWS, the potential impact spans thousands of accounts, threatening data integrity and system security. Amazon's fix and new security features mitigate the risk, highlighting the importance of robust security practices and awareness among users, as improper configuration can leave substantial backdoors open for exploitation by cybercriminals.

Organizations using AWS should prioritize an audit of their AMI retrieval processes, ensuring they specify the AMI owner when using the "ec2:DescribeImages" API and enabling the newly introduced ‘Allowed AMIs’ feature. They should also update infrastructure-as-code tools like Terraform to respond appropriately to warnings when unsafe practices are detected. Running security scanners, such as those provided by DataDog, can identify the use of untrusted AMIs, enabling a switch to ‘Enforcement Mode’ to block them. Continuous monitoring and adapting configurations to align with the latest security best practices are essential for protecting AWS environments from this and similar vulnerabilities.